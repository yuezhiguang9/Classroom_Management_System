<?xml version="1.0" encoding = "UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="demo.campus_management_system.dao.dao_interface.UsersMapper">

    <resultMap id="selectClassroom" type="demo.campus_management_system.entity.DTO.SelectClassroomDTO">
        <result property="building_name" column="building_name"/>
        <result property="room_num" column="room_num"/>
        <result property="capacity" column="room_capacity"/>
        <result property="room_type" column="room_type"/>
        <result property="res_week" column="res_week"/>
        <result property="res_day_of_week" column="res_day_of_week"/>
        <result property="period" column="res_period"/>
        <result property="room_status" column="res_room_status"/>
        <result property="res_date" column="res_date"/>
    </resultMap>
    <select id="selectClassroom" resultMap="selectClassroom">
        select
        building.building_name,classroom.room_num,room_capacity,room_type,res_week,res_day_of_week,res_period,res_room_status,res_date
        from classroom,classroom_resource,building
        where classroom.building_id = building.building_id
        and classroom.room_num = classroom_resource.room_num
        <if test="building_id!=null and building_id !=''">
            and building.building_id = #{building_id}
        </if>
        <if test="capacity!=null">
            and classroom.room_capacity >= #{capacity}
        </if>
        <if test="room_type!=null and room_type !=''">
            and classroom.room_type = #{room_type}
        </if>
        <if test="res_week!=null and res_week !=''">
            and classroom_resource.res_week = #{res_week}
        </if>
        <if test="res_day_of_week!=null and res_day_of_week !=''">
            and classroom_resource.res_day_of_week = #{res_day_of_week}
        </if>
        <if test="period!=null and period !=''">
            and classroom_resource.res_period = #{period}
        </if>
        <if test="room_status!=null and room_status !=''">
            and res_room_status = #{room_status}
        </if>
        <if test="date!=null and date !=''">
            and DATE(res_date) = DATE(#{date})
        </if>

    </select>


</mapper>